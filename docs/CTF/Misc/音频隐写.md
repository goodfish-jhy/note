# 音频隐写技术解析

根据CTF竞赛中音频文件的格式特征，可将其划分为`mp3`和`wav`两大类型：

- **MP3**：采用有损压缩技术

- **WAV**：采用无损编码格式

（注：WAV格式更适用于LSB隐写技术）

下文将系统解析常见音频隐写方法及其技术实现。

## MP3Stego隐写

### 技术特征

- 基于`mp3stego`工具实现隐蔽信息嵌入

- 保持原始音频的听觉保真度

- 需密码验证的加解密机制

### 检测方法

1. 分析音频文件无明显异常特征

2. 使用`strings`命令检索潜在密码

## 波形隐写

### 技术特征

- 时域特征隐蔽（通常为短时脉冲信号）

- 编码方式：ASCII/摩斯电码二进制映射（振幅峰值=1，谷值=0）

- 常见位置：文件头/尾区域

### 分析方法

1. 使用`Audacity`进行波形观测

2. Python脚本自动化提取

   - 注意处理可能的预处理操作（滤波/倒放等）

## 频谱隐写

### 技术特征

- 基于噪声编辑技术

- 听觉特征：显著背景噪声或高频谐波

### 分析方法

1. 使用`Audacity`频谱视图观测

2. 重点分析异常频段能量分布

## 音频置乱算法

!!! abstract
    常见置乱算法技术选型参考：
    - [图像隐写中的Arnold Cat Map扩展应用](https://note.goodfish.site/CTF/Misc/%E5%9B%BE%E5%83%8F%E9%9A%90%E5%86%99/#_6)

### Logistic映射置乱

#### 算法原理

混沌系统特征：

- 初值敏感性

- 伪随机序列生成

#### 数学表达：

$$x_{n+1} = r \cdot x_n \cdot (1 - x_n)$$

  - $x_n \in [0,1]$

  - $r \in [3.57,4]$（混沌态参数）

#### 实现流程

**1-混沌序列生成**

- 初始化参数：$x_0 \in (0,1)$, $r=3.99/4$

- 迭代生成N维序列

- 量化映射至[0,255]整数域

**2-音频预处理**

   - PCM格式转换

   - N点分段处理

**3-置乱操作**

   - 采样点位置置换：$pos_i \rightarrow pos_j$（由混沌序列决定）

**4-解乱操作**

   - 逆向置换算法

   - 依赖初始参数复现混沌序列

```Python
import numpy as np
import soundfile as sf

# Logistic映射生成混沌序列
def logistic_map(x0, r, length):
    sequence = []
    x = x0
    for _ in range(length):
        x = r * x * (1 - x)
        sequence.append(x)
    return np.array(sequence)

# 音频置乱
def audio_scramble(audio, x0, r):
    length = len(audio)
    chaos_seq = logistic_map(x0, r, length)
    # 将混沌序列映射到索引范围
    indices = np.argsort(chaos_seq)
    scrambled_audio = audio[indices]
    return scrambled_audio, indices

# 音频解乱
def audio_descramble(scrambled_audio, indices):
    original_indices = np.argsort(indices)
    descrambled_audio = scrambled_audio[original_indices]
    return descrambled_audio

# 读取音频文件
audio, samplerate = sf.read('input.wav')

# 设置初始值和控制参数
x0 = 0.5
r = 3.99

# 置乱
scrambled_audio, indices = audio_scramble(audio, x0, r)
sf.write('scrambled.wav', scrambled_audio, samplerate)

# 解乱
descrambled_audio = audio_descramble(scrambled_audio, indices)
sf.write('descrambled.wav', descrambled_audio, samplerate)
```

## LSB隐写

### 实践方案

工具推荐：`SilentEye`

自定义实现参考：

  - [音频LSB算法详解](https://blog.csdn.net/qq_55796594/article/details/120285137)

  - [图像LSB技术迁移应用](https://note.goodfish.site/CTF/Misc/%E5%9B%BE%E5%83%8F%E9%9A%90%E5%86%99/#lsbmsb)

## SSTV解码技术

### 实施方案
1. 移动端解码：`Robot36`应用
2. 物理连接方案：3.5mm音频环回线路
3. 环境要求：信噪比>30dB

## DTMF解析

### 解码方案
1. 在线检测：[DialABC音频分析](http://dialabc.com/sound/detect/index.html)
2. 本地工具：`dtmf2num -o [文件路径]`

## 声道隐写

### 处理技术
**1-声道运算策略**

   - 差分处理

   - 乘积运算

**2-精度控制方案**

   - 整数转换：$×10^7$缩放因子

   - 浮点恢复处理

## 工具集合
参考：[音频隐写工具大全](https://lazzzaro.github.io/2020/06/20/misc-%E6%96%87%E4%BB%B6%E9%9A%90%E5%86%99/#%E9%9F%B3%E9%A2%91%E7%B1%BB)
